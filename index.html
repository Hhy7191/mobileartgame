<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>ë‚˜ë§Œì˜ ì•„íŠ¸ ìŠ¤íŠœë””ì˜¤</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    /* Mobile optimization: touch-action: none prevents scrolling/panning while drawing */
    #drawingCanvas { background-color: #fff; touch-action: none; border: 1px solid #e5e7eb; max-width: 100%; height: auto; }
    .cursor-brush { cursor: crosshair; }
    .cursor-text { cursor: text; }
    .cursor-grab { cursor: grab !important; }
    .template-thumbnail {
      width: 40px; height: 40px; object-fit: cover; cursor: pointer;
      border-radius: 6px; border: 2px solid transparent; transition: transform 0.1s;
    }
    .template-thumbnail:hover { transform: scale(1.05); }
    .template-thumbnail.active { border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59,130,246,0.5); }
    #messageBox { opacity: 0; transition: opacity 0.3s, transform 0.3s; transform: translateY(10px) translateX(-50%); white-space: nowrap; }
    #messageBox.show { opacity: 1; transform: translateY(0) translateX(-50%); }

    /* Fix iOS input focus zoom issue */
    input[type="text"], textarea { font-size: 16px; }
  </style>
</head>

<body class="bg-gray-50 min-h-screen p-3 flex flex-col items-center">
  <div id="messageBox" class="fixed top-5 left-1/2 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-xl z-50"></div>

  <div class="w-full max-w-5xl bg-white rounded-xl shadow-2xl p-4 sm:p-6 space-y-4">
    <header class="text-center">
      <h1 class="text-2xl sm:text-3xl font-extrabold text-gray-800 flex items-center justify-center space-x-2">
        <i data-lucide="palette" class="w-6 h-6 sm:w-7 sm:h-7 text-blue-600"></i>
        <span>ë‚˜ë§Œì˜ ì•„íŠ¸ ìŠ¤íŠœë””ì˜¤</span>
      </h1>
      <p class="text-gray-500 mt-1 text-sm sm:text-base">ë¡œë¥´ìƒ¤í ì´ë¯¸ì§€ ìœ„ì—ì„œ ë‹¹ì‹ ì˜ ìƒìƒë ¥ì„ í‘œí˜„í•´ë³´ì„¸ìš”.</p>
    </header>

    <!-- í…œí”Œë¦¿ -->
    <div class="p-3 bg-gray-100 rounded-xl shadow-inner">
      <span class="text-sm font-semibold text-gray-700 block mb-2">ğŸ¨ ë°°ê²½ í…œí”Œë¦¿ ì„ íƒ</span>
      <div id="templateContainer" class="flex space-x-3 overflow-x-auto pb-1"></div>
    </div>

    <!-- ë„êµ¬ + ìº”ë²„ìŠ¤ (ëª¨ë°”ì¼ì—ì„œ ì„¸ë¡œ ë°°ì—´) -->
    <div class="flex flex-col lg:flex-row space-y-4 lg:space-x-4">
      <div class="bg-gray-100 p-4 rounded-xl shadow-lg lg:w-48 flex flex-col space-y-3 order-2 lg:order-1">
        
        <!-- ë„êµ¬ ë²„íŠ¼ -->
        <div class="flex space-x-3">
          <button id="brushTool" class="tool-button w-10 h-10 bg-blue-500 text-white rounded-lg active" data-mode="brush">
            <i data-lucide="paintbrush" class="w-5 h-5 mx-auto"></i>
          </button>
          <button id="textTool" class="tool-button w-10 h-10 bg-gray-600 text-white rounded-lg" data-mode="text">
            <i data-lucide="type" class="w-5 h-5 mx-auto"></i>
          </button>
        </div>

        <label class="text-sm font-medium text-gray-700">ìƒ‰ìƒ ì„ íƒ</label>
        <input type="color" id="colorPicker" value="#000000" class="w-full h-8 rounded-md border-2 border-gray-300" />

        <label class="text-sm font-medium text-gray-700">í…ìŠ¤íŠ¸ ë‚´ìš©</label>
        <input type="text" id="textInput" placeholder="ì…ë ¥ í›„ ìº”ë²„ìŠ¤ í´ë¦­" class="w-full p-2 rounded-md border border-gray-300 text-gray-800" />
        <p id="textHint" class="text-xs text-red-500 hidden">ì…ë ¥ í›„ ìº”ë²„ìŠ¤ í„°ì¹˜/í´ë¦­</p>

        <div class="h-px bg-gray-300 my-2"></div>
        <label class="text-sm font-medium text-gray-700">í¬ê¸°: <span id="sizeValue">5</span>px</label>
        <input type="range" id="sizeSlider" min="1" max="50" value="5" class="w-full" />
      </div>

      <!-- ìº”ë²„ìŠ¤ ì˜ì—­ -->
      <div class="flex-grow bg-gray-200 rounded-xl shadow-inner flex justify-center items-center p-2 order-1 lg:order-2">
        <canvas id="drawingCanvas" class="rounded-lg shadow-xl"></canvas>
      </div>
    </div>

    <!-- ë²„íŠ¼ -->
    <div class="flex flex-wrap justify-center gap-3 sm:gap-4 pt-4 border-t border-gray-200">
      <button id="saveButton" class="flex-1 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-3 sm:px-6 rounded-xl text-sm sm:text-base">
        <i data-lucide="share-2" class="w-5 h-5 inline mr-1 sm:mr-2"></i> ì €ì¥ & ê³µìœ  (ëª¨ë°”ì¼ ìµœì í™”)
      </button>
      <button id="undoButton" class="flex-1 min-w-[120px] bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-3 sm:px-6 rounded-xl text-sm sm:text-base">
        <i data-lucide="undo-2" class="w-5 h-5 inline mr-1 sm:mr-2"></i> ë˜ëŒë¦¬ê¸°
      </button>
      <button id="clearButton" class="flex-1 min-w-[120px] bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-3 sm:px-6 rounded-xl text-sm sm:text-base">
        <i data-lucide="trash-2" class="w-5 h-5 inline mr-1 sm:mr-2"></i> ì „ì²´ ì§€ìš°ê¸°
      </button>
    </div>

    <div class="pt-4">
      <h2 class="text-lg font-semibold text-gray-700 mb-2">âœ¨ ë‚˜ë§Œì˜ ì˜ê° / í”„ë¡¬í”„íŠ¸ ì…ë ¥</h2>
      <textarea id="promptInput" placeholder="ì´ ê·¸ë¦¼ì— ëŒ€í•œ ìƒê°ì„ ì¨ë³´ì„¸ìš”." class="w-full p-3 h-24 border border-gray-300 rounded-lg resize-none"></textarea>
      <p class="text-sm text-gray-500 mt-1">ë‹¤ìš´ë¡œë“œ ì‹œ ì´ ë‚´ìš©ì´ ê·¸ë¦¼ í•˜ë‹¨ì— ì¶”ê°€ë©ë‹ˆë‹¤. (íŒ¨ë“¤ë ›: <a href="https://padlet.com/hy7191/padlet-vvey0i7aoep7kju6" target="_blank" class="text-blue-500 hover:text-blue-700">ê³µìœ  í˜ì´ì§€</a>)</p>
    </div>
  </div>

  <script>
    lucide.createIcons();

    const canvas = document.getElementById("drawingCanvas");
    const ctx = canvas.getContext("2d");
    const PADLET_URL = "https://padlet.com/hy7191/padlet-vvey0i7aoep7kju6";
    const templates = [
      { name: "ë¡œë¥´ìƒ¤í 1", url: "https://i.postimg.cc/kg20RfFr/1.png" },
      { name: "ë¡œë¥´ìƒ¤í 2", url: "https://i.postimg.cc/T3BZVgCY/2.png" },
      { name: "ë¡œë¥´ìƒ¤í 3", url: "https://i.postimg.cc/Jn3V40Ng/3.png" },
      { name: "ë¡œë¥´ìƒ¤í 4", url: "https://i.postimg.cc/rmGXFsGm/4.png" },
      { name: "ë¡œë¥´ìƒ¤í 5", url: "https://i.postimg.cc/nzKbcrKf/5.png" },
      { name: "ë¡œë¥´ìƒ¤í 6", url: "https://i.postimg.cc/ZRzzSpdM/6.png" },
      { name: "ë¡œë¥´ìƒ¤í 7", url: "https://i.postimg.cc/6q9s7KzL/7.png" },
      { name: "ë¡œë¥´ìƒ¤í 8", url: "https://i.postimg.cc/j2vpP1FY/8.png" },
      { name: "ë¡œë¥´ìƒ¤í 9", url: "https://i.postimg.cc/cLPVRwT2/9.png" },
      { name: "ë¡œë¥´ìƒ¤í 10", url: "https://i.postimg.cc/CxR3nmHT/10.png" }
    ];

    let currentTemplateUrl = "";
    let currentColor = "#000000";
    let currentSize = 5;
    let drawingMode = "brush";
    let isDrawing = false;
    let pendingText = "";
    let history = [];

    // --- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ---

    // ë§ˆìš°ìŠ¤ ë° í„°ì¹˜ ì´ë²¤íŠ¸ì˜ ì¢Œí‘œë¥¼ ì •ê·œí™”í•©ë‹ˆë‹¤. (ëª¨ë°”ì¼ ëŒ€ì‘ í•µì‹¬)
    function getEventCoords(event) {
      const rect = canvas.getBoundingClientRect();
      let clientX, clientY;
      
      // í„°ì¹˜ ì´ë²¤íŠ¸ ì²˜ë¦¬
      if (event.touches && event.touches.length > 0) {
        clientX = event.touches[0].clientX;
        clientY = event.touches[0].clientY;
      } 
      // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ ì²˜ë¦¬
      else {
        clientX = event.clientX;
        clientY = event.clientY;
      }

      return {
        x: clientX - rect.left,
        y: clientY - rect.top,
      };
    }

    function showMessage(msg, t = 4000) {
      const box = document.getElementById("messageBox");
      box.textContent = msg;
      box.classList.add("show");
      setTimeout(() => box.classList.remove("show"), t);
    }

    function resizeCanvas() {
      const container = canvas.parentElement;
      // ìº”ë²„ìŠ¤ í¬ê¸°ë¥¼ ì»¨í…Œì´ë„ˆì— ë§ì¶¥ë‹ˆë‹¤. ëª¨ë°”ì¼ì—ì„œ ë„ˆë¬´ ì»¤ì§€ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ìµœëŒ€ ë„ˆë¹„ ì œí•œ
      const newWidth = Math.min(container.clientWidth - 20, 800); 
      canvas.width = newWidth;
      canvas.height = newWidth * 0.75; // 4:3 ë¹„ìœ¨ ìœ ì§€

      // ìº”ë²„ìŠ¤ í¬ê¸°ê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ í…œí”Œë¦¿ì„ ë‹¤ì‹œ ê·¸ë¦½ë‹ˆë‹¤.
      if (currentTemplateUrl) {
        drawTemplate(currentTemplateUrl, history.length > 0 ? history[history.length - 1] : null);
      }
    }

    function saveState() {
      // ìº”ë²„ìŠ¤ í¬ê¸°ê°€ 0ì´ ì•„ë‹ ë•Œë§Œ ì €ì¥
      if (canvas.width > 0 && canvas.height > 0) {
          if (history.length > 20) history.shift();
          history.push(canvas.toDataURL());
      }
    }

    function drawTemplate(url, imageDataUrl = null) {
      const img = new Image();
      img.crossOrigin = "Anonymous";
      img.onload = () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // í…œí”Œë¦¿ ì´ë¯¸ì§€ ê·¸ë¦¬ê¸°
        const imgRatio = img.width / img.height;
        const canvasRatio = canvas.width / canvas.height;
        const scale = 0.5;
        let dw, dh;
        if (imgRatio > canvasRatio) {
          dw = canvas.width * scale;
          dh = dw / imgRatio;
        } else {
          dh = canvas.height * scale;
          dw = dh * imgRatio;
        }
        const dx = (canvas.width - dw) / 2;
        const dy = (canvas.height - dh) / 2;
        ctx.drawImage(img, dx, dy, dw, dh);

        // ì €ì¥ëœ ì´ë¯¸ì§€ ë°ì´í„°ê°€ ìˆë‹¤ë©´ ë³µì›
        if (imageDataUrl) {
            const historyImg = new Image();
            historyImg.onload = () => ctx.drawImage(historyImg, 0, 0, canvas.width, canvas.height);
            historyImg.src = imageDataUrl;
        }

        saveState();
      };
      img.src = url;
      // í…œí”Œë¦¿ì´ ë¡œë“œë˜ì§€ ì•Šì„ ê²½ìš°ì˜ ëŒ€ì²´ ì²˜ë¦¬ (ì„ íƒ ì‚¬í•­)
      img.onerror = () => showMessage("âš ï¸ í…œí”Œë¦¿ ì´ë¯¸ì§€ ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ê¸°ë³¸ ë°°ê²½ì´ ì‚¬ìš©ë©ë‹ˆë‹¤.", 5000);
    }

    function initTemplates() {
      const container = document.getElementById("templateContainer");
      templates.forEach((tpl, i) => {
        const img = document.createElement("img");
        img.src = tpl.url;
        img.title = tpl.name;
        img.className = "template-thumbnail";
        if (i === 0) img.classList.add("active");

        img.addEventListener("click", () => {
          document.querySelectorAll(".template-thumbnail").forEach(t => t.classList.remove("active"));
          img.classList.add("active");
          currentTemplateUrl = tpl.url;
          drawTemplate(tpl.url); // ìƒˆ í…œí”Œë¦¿ ë¡œë“œ ì‹œ ê¸°ë¡ ì‚­ì œ ë° ìƒˆë¡œ ê·¸ë¦¬ê¸°
        });
        container.appendChild(img);
        if (i === 0) {
          currentTemplateUrl = tpl.url;
          drawTemplate(tpl.url);
        }
      });
    }

    // --- ë“œë¡œì‰ ë° í„°ì¹˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ (ëª¨ë°”ì¼/ë°ìŠ¤í¬í†± í†µí•©) ---

    function startDraw(e) {
      e.preventDefault(); // ìŠ¤í¬ë¡¤ ë°©ì§€
      const coords = getEventCoords(e);
      if (drawingMode === "brush") {
        isDrawing = true;
        ctx.beginPath();
        ctx.moveTo(coords.x, coords.y);
      }
    }

    function draw(e) {
      e.preventDefault(); // ìŠ¤í¬ë¡¤ ë°©ì§€
      const coords = getEventCoords(e);
      if (isDrawing && drawingMode === "brush") {
        ctx.lineTo(coords.x, coords.y);
        ctx.strokeStyle = currentColor;
        ctx.lineWidth = currentSize;
        ctx.lineCap = "round";
        ctx.lineJoin = "round";
        ctx.stroke();
      }
    }

    function stopDraw() {
      if (isDrawing) {
        isDrawing = false;
        saveState();
      }
    }

    // ë“œë¡œì‰ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
    canvas.addEventListener("mousedown", startDraw);
    canvas.addEventListener("mousemove", draw);
    canvas.addEventListener("mouseup", stopDraw);
    canvas.addEventListener("mouseleave", () => { if (isDrawing) stopDraw(); });

    canvas.addEventListener("touchstart", startDraw);
    canvas.addEventListener("touchmove", draw);
    canvas.addEventListener("touchend", stopDraw);


    // âœï¸ í…ìŠ¤íŠ¸ ëª¨ë“œ
    document.getElementById("textInput").addEventListener("input", e => {
      pendingText = e.target.value.trim();
      document.getElementById("textHint").classList.toggle("hidden", !pendingText || drawingMode !== "text");
    });
    
    document.getElementById("textInput").addEventListener("focus", () => {
        if (drawingMode === "text") {
            document.getElementById("textHint").classList.remove("hidden");
        }
    });
    
    document.getElementById("textInput").addEventListener("blur", () => {
        if (!pendingText) {
            document.getElementById("textHint").classList.add("hidden");
        }
    });

    function placeText(e) {
      // í„°ì¹˜ ì´ë²¤íŠ¸ì¸ ê²½ìš°, ë“œë¡œì‰ì´ ì‹œì‘ë˜ì§€ ì•Šì•˜ì„ ë•Œë§Œ í…ìŠ¤íŠ¸ ë°°ì¹˜ í—ˆìš©
      if (e.type === 'touchend' && isDrawing) return;

      if (drawingMode === "text" && pendingText) {
        const coords = getEventCoords(e);
        ctx.fillStyle = currentColor;
        // ëª¨ë°”ì¼ì—ì„œë„ ê°€ë…ì„± ìˆë„ë¡ ê¸€ê¼´ í¬ê¸° ì„¤ì •
        ctx.font = `bold ${currentSize * 3}px Inter`;
        ctx.textAlign = "center";
        ctx.fillText(pendingText, coords.x, coords.y);
        
        // í…ìŠ¤íŠ¸ ë°°ì¹˜ í›„ ìƒíƒœ ì´ˆê¸°í™”
        pendingText = "";
        document.getElementById("textInput").value = ""; 
        document.getElementById("textHint").classList.add("hidden");
        saveState();
        showMessage("í…ìŠ¤íŠ¸ê°€ ë°°ì¹˜ë˜ì—ˆìŠµë‹ˆë‹¤.", 2000);
      }
    }
    
    // í…ìŠ¤íŠ¸ ë°°ì¹˜ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    canvas.addEventListener("click", placeText);
    canvas.addEventListener("touchend", placeText);


    // ğŸ¨ ë„êµ¬ ì´ë²¤íŠ¸
    document.querySelectorAll(".tool-button").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll(".tool-button").forEach(b => {
          b.classList.remove("bg-blue-500", "active");
          b.classList.add("bg-gray-600");
        });
        btn.classList.remove("bg-gray-600");
        btn.classList.add("bg-blue-500", "active");
        drawingMode = btn.dataset.mode;
        
        // íŒíŠ¸ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
        document.getElementById("textHint").classList.add("hidden");
        if (drawingMode === "text" && pendingText) {
             document.getElementById("textHint").classList.remove("hidden");
             showMessage("í…ìŠ¤íŠ¸ ëª¨ë“œ: ì…ë ¥ í›„ ìº”ë²„ìŠ¤ í´ë¦­/í„°ì¹˜", 3000);
        } else if (drawingMode === "brush") {
             showMessage("ë¸ŒëŸ¬ì‹œ ëª¨ë“œ: ììœ ë¡­ê²Œ ê·¸ë¦¬ê¸°", 3000);
        }
      });
    });

    document.getElementById("colorPicker").addEventListener("input", e => currentColor = e.target.value);
    document.getElementById("sizeSlider").addEventListener("input", e => {
      currentSize = e.target.value;
      document.getElementById("sizeValue").textContent = currentSize;
    });

    // â†©ï¸ ë˜ëŒë¦¬ê¸° ê¸°ëŠ¥
    document.getElementById("undoButton").addEventListener("click", () => {
      if (history.length > 1) {
        history.pop();
        // í˜„ì¬ ìº”ë²„ìŠ¤ ìƒíƒœë¥¼ ë¹„ìš°ê³  ì§ì „ ìƒíƒœë¥¼ ë³µì›í•©ë‹ˆë‹¤.
        const prevDataUrl = history[history.length - 1];
        const img = new Image();
        img.onload = () => {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
        };
        img.src = prevDataUrl;
        showMessage("ë˜ëŒë¦¬ê¸° ì™„ë£Œ!", 1000);
      } else {
        showMessage("ë” ì´ìƒ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.", 1000);
      }
    });

    // ğŸ—‘ ì „ì²´ ì§€ìš°ê¸° ê¸°ëŠ¥
    document.getElementById("clearButton").addEventListener("click", () => drawTemplate(currentTemplateUrl));


    // --- ğŸ’¾ ë‹¤ìš´ë¡œë“œ/ê³µìœ  ê¸°ëŠ¥ (ëª¨ë°”ì¼ ìµœì í™”) ---
    
    // ì „í†µì ì¸ ë‹¤ìš´ë¡œë“œ (ë°ìŠ¤í¬í†± ë° í´ë°±ìš©)
    function traditionalDownload(canvasToDownload) {
      const imageURL = canvasToDownload.toDataURL("image/png");
      const a = document.createElement("a");
      a.href = imageURL;
      a.download = `ë‚˜ë§Œì˜-ì•„íŠ¸-${Date.now()}.png`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      showMessage("ğŸ–¼ ê·¸ë¦¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!", 3000);
    }

    document.getElementById("saveButton").addEventListener("click", async () => {
      // 1. ìµœì¢… ì´ë¯¸ì§€ ì¤€ë¹„ (í”„ë¡¬í”„íŠ¸ í…ìŠ¤íŠ¸ í¬í•¨)
      const tempCanvas = document.createElement("canvas");
      tempCanvas.width = canvas.width;
      tempCanvas.height = canvas.height;
      const tctx = tempCanvas.getContext("2d");
      tctx.drawImage(canvas, 0, 0);

      const prompt = document.getElementById("promptInput").value.trim();
      if (prompt) {
        tctx.fillStyle = "#000";
        tctx.font = "bold 18px Inter, sans-serif";
        tctx.textAlign = "center";
        // ìº”ë²„ìŠ¤ í¬ê¸°ì— ë”°ë¼ ìœ„ì¹˜ ì¡°ì •
        tctx.fillText(`âœ¨ Prompt: ${prompt.substring(0, 50)}...`, tempCanvas.width / 2, tempCanvas.height - 20);
      }

      // 2. Web Share API ì‚¬ìš© (ëª¨ë°”ì¼ ìµœì )
      if (navigator.share) {
        try {
          // toBlob() ëŒ€ì‹  toDataURL()ì„ ì‚¬ìš©í•´ base64 ì´ë¯¸ì§€ ìƒì„±
          const dataURL = tempCanvas.toDataURL('image/png');
          
          // dataURLì„ Blobìœ¼ë¡œ ë³€í™˜
          const blob = await new Promise(resolve => tempCanvas.toBlob(resolve, 'image/png'));
          const file = new File([blob], `ë‚˜ë§Œì˜-ì•„íŠ¸-${Date.now()}.png`, { type: 'image/png' });

          await navigator.share({
            files: [file],
            title: 'ë‚˜ë§Œì˜ ì•„íŠ¸ ìŠ¤íŠœë””ì˜¤ ì‘í’ˆ',
            text: `ë‚˜ë§Œì˜ ë¡œë¥´ìƒ¤í ê·¸ë¦¼ì„ ê³µìœ í•©ë‹ˆë‹¤! ì˜ê°: ${prompt || 'ì—†ìŒ'}`,
          });
          showMessage("ğŸ–¼ ê·¸ë¦¼ì´ ì„±ê³µì ìœ¼ë¡œ ê³µìœ /ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!", 3000);
        } catch (error) {
          // ê³µìœ  ì·¨ì†Œ ë˜ëŠ” ì‹¤íŒ¨ ì‹œ (e.g., File Share API ë¯¸ì§€ì›) ì „í†µ ë‹¤ìš´ë¡œë“œë¡œ í´ë°±
          console.error('Sharing failed:', error);
          traditionalDownload(tempCanvas);
        }
      } else {
        // 3. Web Share API ë¯¸ì§€ì› ì‹œ ì „í†µ ë‹¤ìš´ë¡œë“œ
        traditionalDownload(tempCanvas);
      }
    });

    // --- ì´ˆê¸°í™” ---
    window.addEventListener("load", () => {
      resizeCanvas();
      initTemplates();
    });
    window.addEventListener("resize", () => {
        // ë¦¬ì‚¬ì´ì¦ˆ ì‹œì—ë§Œ ìº”ë²„ìŠ¤ í¬ê¸°ë¥¼ ì¡°ì •í•˜ê³ , í˜„ì¬ ë‚´ìš©ì´ ìœ ì§€ë˜ë„ë¡ ì²˜ë¦¬í•©ë‹ˆë‹¤.
        resizeCanvas();
    });
  </script>
</body>
</html>